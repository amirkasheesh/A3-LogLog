# Реализация вероятностного алгоритма HyperLogLog

## Результаты экспериментов

В ходе работы были проведены эксперименты для оценки влияния параметра $b$ (количество бит, используемых для адресации регистров) на точность и дисперсию оценки мощности множества.

### Этап 3: Базовая проверка ($b = 5$)

* **Количество регистров:** $m = 2^5 = 32$.
* **Используемая память:** 32 байта.
* **Теоретическая относительная ошибка:** приблизительно $1.04 / \sqrt{32}$.

**Анализ:**  
При малом количестве регистров наблюдается высокая дисперсия оценки. Линия вероятностной оценки в целом повторяет рост истинного значения, однако заметны существенные отклонения. Полученные результаты соответствуют теоретическим ожиданиям.

---

### Этап 4: Повышение точности ($b = 12$)

* **Количество регистров:** $m = 2^{12} = 4096$.
* **Используемая память:** 4 КБ.
* **Теоретическая относительная ошибка:** приблизительно $1.04 / \sqrt{4096}$.

**Анализ:**  
Увеличение объема памяти приводит к резкому снижению дисперсии и повышению точности оценки. Вероятностная оценка практически совпадает с результатом точного подсчета, что подтверждает эффективность алгоритма HyperLogLog.

---

## Теоретическое обоснование

Алгоритм HyperLogLog использует оценку мощности множества на основе гармонического среднего максимальных рангов ведущих нулей в хеш-значениях элементов:

$\hat{N} = \alpha_m m^2 \left( \sum_{i=1}^{m} 2^{-M_i} \right)^{-1}$

где:

* $m$ — количество регистров,
* $M_i$ — максимальный ранг в $i$-м регистре,
* $\alpha_m$ — эмпирическая константа коррекции смещения.

Стандартная относительная ошибка алгоритма аппроксимируется формулой:

$\varepsilon \approx \frac{1.04}{\sqrt{m}}$

Экспериментальные результаты подтвердили данную зависимость: увеличение числа регистров в 128 раз привело к уменьшению ошибки примерно в $\sqrt{128}$ раз.

---

## Выводы

В ходе выполнения домашнего задания:

1. Реализован вероятностный алгоритм HyperLogLog.
2. Экспериментально подтверждена высокая эффективность алгоритма при работе с большими потоками данных.
3. Продемонстрирован компромисс между потребляемой памятью и точностью оценки.
4. Показано существенное преимущество HyperLogLog по потреблению памяти по сравнению с точным подсчетом на основе `std::unordered_set`.

